# Gemini Deep Miner (离线版)

这是一个基于 React + Tailwind CSS 的网页版深渊挖掘生存游戏。玩家需要扮演矿工深入地下，管理氧气，挖掘稀有矿物，并返回地表升级装备。

本项目经过了多次迭代，从最初的简单挖掘演示发展为包含程序化地图生成、物理音效、粒子动画和完整经济循环的离线游戏。

## 🛠 技术栈

- **核心框架**: React 19
- **样式**: Tailwind CSS (通过 CDN 引入)
- **图标**: Lucide React
- **构建/运行**: 无需构建步骤 (No-Build)，直接通过 ES Modules 在浏览器运行。
- **音效**: Web Audio API (纯代码生成，无外部音频资源)。
- **AI**: 模拟规则引擎 (替代了原本的 Google Gemini API，实现完全离线运行)。

## 🌟 核心机制

### 1. 核心循环
- **挖掘**: 点击方向键移动/挖掘。挖掘时间随矿物硬度和镐子等级变化。
- **生存**: 氧气随时间流逝，深度越深消耗越快 (`Depth Penalty`)。氧气耗尽即游戏结束。
- **经济**: 背包满了后需返回地表 (`y=0`) 的交易所出售矿物。
- **升级**: 使用资金升级镐子、氧气瓶、货舱、扫描仪、外骨骼和钻头。

### 2. 地图生成 (`services/gameLogic.ts`)
- 使用 **伪柏林噪声 (Pseudo-Perlin Noise)** 生成地形。
- **深度分层**: 地图分为 6 个深度层级，不同层级有不同的矿物分布。
- **空腔系统 (Caves)**: 噪声阈值生成的连通空洞，方便快速穿梭。
- **矿脉 (Veins)**: 稀有的高密度矿物聚集区，鼓励探索。
- **迷雾与视野**: 
  - 默认只能看到相邻方块。
  - 升级 **扫描仪** 可获得穿墙视野 (半径 1-4)。
  - 进入 **空腔** 时，会自动照亮整个连通的空洞区域 (Flood Fill)。

### 3. 物品与掉落
- **品质系统**: 矿物挖掘时随机获得品质 (粗糙/普通/优质/完美)，影响价值。
- **掉落机制**: 背包满时挖掘，矿物会以物理形式掉落在地图上。
- **生命周期**: 掉落物在 60 秒后自动消失。
- **拾取**: 移动到掉落物格子上自动拾取。

### 4. 设施
- **交易所**: 位于地表左侧。玩家必须物理移动到该位置才能打开商店。包含“矿工评价”系统（规则驱动）。
- **电梯**: 位于地表右侧。当玩家到达特定深度 (50m, 100m...) 时解锁，之后可快速往返。

## 🎨 视觉与音效

- **视觉**:
  - 矿工 SVG 角色，带有挖掘动画。
  - 矿石带有辉光和粒子效果 (特别是稀有矿物)。
  - 动态 HUD，液体氧气管效果。
  - 物品飞入背包的动画 (`FlyingItemOverlay`)。
  - 挖掘出的浮动文字 (`FloatingTextOverlay`)。
  - 返回地表的转场动画。
  
- **音效 (`services/audioService.ts`)**:
  - 使用振荡器 (Oscillators) 和 噪声节点 (Noise Buffers) 实时合成。
  - 包含：金属挖掘声、岩石破碎声、气泡拾取声、收银机声、警报声等。

## 📅 开发迭代历史 (Context Log)

1.  **原型阶段**: 建立了基础网格移动和挖掘逻辑。
2.  **本地化**: 全面中文化 (文本、提示)。
3.  **UI 优化**: 增加了背包显示，鼠标悬浮提示，解决了移动端遮挡问题。
4.  **数值重平衡**: 
    - 移除了挖掘扣除氧气的设定，改为纯时间消耗。
    - 大幅增加了挖掘耗时，增加了“沉重感”。
    - 调整了经济模型，以适应慢节奏挖掘。
5.  **视觉增强**: 
    - 增加了矿工挖掘动作 (挥镐)。
    - 增加了矿石发光特效。
    - 增加了地表建筑 (交易所/电梯) 的视觉表现。
6.  **功能扩展**:
    - **钻头升级**: 允许一次挖掘多格 (1x2, 2x2, 3x3)。
    - **外骨骼**: 增加移动速度。
    - **电梯系统**: 快速传送。
7.  **离线化改造**: 
    - 移除了 `GoogleGenAI` 依赖。
    - 实现了一套本地规则算法，根据矿物价值和稀有度生成评价文本。
8.  **细节打磨**:
    - 掉落物系统。
    - 目标指引 (HUD 顶部提示)。
    - 空腔视野扩散算法。

## 🕹️ 如何运行

本项目为单文件结构 (逻辑分离在 ts 文件中，但无需打包工具)。
直接在支持 React 的即时预览环境中运行，或配置简单的 HTTP 服务器加载 `index.html`。

---
*此文件由 AI 助手根据对话上下文自动生成，用于记录项目状态。*
